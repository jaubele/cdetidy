% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sql_schema_log_warehouse.R
\name{sql_schema_log_warehouse}
\alias{sql_schema_log_warehouse}
\title{Generate and log a SQL schema for a data frame}
\usage{
sql_schema_log_warehouse(
  data,
  table_name,
  data_year,
  data_source,
  user_note = NA,
  dim_description = NULL,
  max_char = 255,
  primary_key = NULL,
  foreign_keys = NULL,
  canonical_table_id = NULL,
  dimension_type = NULL
)
}
\arguments{
\item{data}{A data frame to analyze.}

\item{table_name}{The base name of the SQL table.}

\item{data_year}{A 4-digit year indicating the data vintage.}

\item{data_source}{A string identifying the data source (must be \code{"Assessment"}, \code{"CDE"}, or \code{"Dashboard"}).}

\item{user_note}{A short note describing the data (must include \code{"fact"} or \code{"dim"}).}

\item{dim_description}{Optional. A short label describing the dimension content (e.g., \code{"race_ethnicity"}).}

\item{max_char}{Maximum length to assign to character columns (default is 255).}

\item{primary_key}{A character vector of column(s) that make up the primary key.}

\item{foreign_keys}{A named character vector like \code{c("column_name" = "ref_table")}.}

\item{canonical_table_id}{Optional. A unique ID for the table. Defaults to \code{table_name}.}

\item{dimension_type}{Optional. One of \code{"universal"}, \code{"annualized"}, or \code{"other"} (used only for dimension tables).}
}
\value{
A tibble containing the schema definition for the input data. The result is also written to:
\itemize{
\item The central schema log: \verb{T:/Data Warehouse/schema_files/primary_sql_schema_log.csv}
\item An individual schema file by table: \verb{T:/Data Warehouse/schema_files/<year>/<source>/<fact|dim>/<table>_schema.csv}
}
}
\description{
Builds a schema definition table from a data frame by inspecting its column types, nullability,
and primary/foreign key indicators. The schema is saved to a central log (\code{primary_sql_schema_log.csv})
and to an individual table-level schema file.
}
\details{
\itemize{
\item Infers SQL column types (\code{VARCHAR}, \code{INT}, \code{DECIMAL}, etc.) based on data values.
\item Enforces uniqueness and completeness of primary key.
\item Validates format and existence of foreign key mappings.
\item Updates the central log by replacing existing entries for the same \code{canonical_table_id}.
}
}
