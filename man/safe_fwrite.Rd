% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/safe_fwrite.R
\name{safe_fwrite}
\alias{safe_fwrite}
\title{Safely write a dataset to CSV with metadata logging}
\usage{
safe_fwrite(
  data,
  path = NULL,
  char_cols = c("cds", "county_code", "district_code", "school_code"),
  compress = FALSE,
  n_check = 6,
  log_metadata = NULL,
  data_year = NULL,
  data_source = NULL,
  data_description = NA,
  user_note = NA,
  table_name = NULL,
  dim_description = NULL,
  log_path = "export_log.csv",
  canonical_table_id = NULL,
  dimension_type = NULL
)
}
\arguments{
\item{data}{A data frame to export.}

\item{path}{Optional. Full file path to write the CSV. If \code{NULL}, a path is generated automatically based on metadata.}

\item{char_cols}{A character vector of column names to convert to character before export. Default is \code{c("cds", "county_code", "district_code", "school_code")}.}

\item{compress}{Logical. If \code{TRUE}, appends \code{.gz} to the filename and compresses the output. Default is \code{FALSE}.}

\item{n_check}{Integer. Number of rows to preview after writing. Default is 6.}

\item{log_metadata}{A named list containing metadata fields, including \code{data_year}, \code{data_source}, \code{data_description}, and \code{user_note}. If \code{NULL}, the function uses the corresponding individual arguments.}

\item{data_year}{The year the data represents. Required if \code{log_metadata} is not supplied.}

\item{data_source}{A short label identifying the source of the data (e.g., \code{"CDE"}, \code{"Dashboard"}).}

\item{data_description}{A short description of the dataset (e.g., \code{"Chronic absenteeism rates by subgroup"}).}

\item{user_note}{A note describing the nature of the export. Must include \code{"fact"} or \code{"dim"} to indicate table type.}

\item{table_name}{The base name of the output table.}

\item{dim_description}{Optional. A short label used to describe the dimension (e.g., \code{"race_ethnicity"}). Appended to the file name.}

\item{log_path}{The path to the export log CSV. Default is \code{"export_log.csv"}.}

\item{canonical_table_id}{Optional. A unique identifier for the exported table. Defaults to \code{table_name} if \code{NULL}.}

\item{dimension_type}{Optional. One of \code{"universal"}, \code{"annualized"}, or \code{"other"}. Applies to dimension tables.}
}
\value{
Invisibly returns \code{NULL}. The function writes the data to disk and logs metadata to a central log file.
}
\description{
Writes a data frame to a standardized T drive location (or user-defined path), enforces character
types on specific ID columns, applies optional compression, and logs metadata to a central export log.
Supports both fact and dimension tables and validates metadata inputs before writing.
}
\details{
\itemize{
\item Validates required metadata fields and data source types.
\item Pads dimension codes as needed and enforces character types on key fields.
\item If \code{log_path} exists, overwrites log entry for the same \code{canonical_table_id}, otherwise appends a new row.
\item Automatically creates directories if needed and checks file size after writing.
}
}
